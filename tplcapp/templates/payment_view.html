{% load static %}

<html>

   {% include "include_head.html" %}
   <style>

      /* General Reset */

      * {

      margin: 0;

      padding: 0;

      box-sizing: border-box;

      }

      .content-wrapper {

      font-family: Arial, sans-serif;

      background-color: #f5f5f5;

      display: flex;

      justify-content: center;

      align-items: center;

      min-height: 100vh;

      padding: 20px;

      }

      .receipt {

      max-width: 800px;

      width: 100%;

      background: #fff;

      border-radius: 8px;

      position: relative;

      overflow: hidden;

      border: 1px solid #ddd;

      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);

      }

      /* Yellow Corners */

      .receipt::before,

      .receipt::after,

      .receipt .corner-top-right,

      .receipt .corner-bottom-left {

      content: '';

      position: absolute;

      width: 40px;

      height: 40px;

      background-color: #f7b500;

      }

      .receipt::before {

      top: 0;

      left: 0;

      clip-path: polygon(0 0, 100% 0, 0 100%);

      }

      .receipt::after {

      bottom: 0;

      right: 0;

      clip-path: polygon(100% 100%, 0 100%, 100% 0);

      }

      .receipt .corner-top-right {

      top: 0;

      right: 0;

      clip-path: polygon(100% 0, 100% 100%, 0 0);

      }

      .receipt .corner-bottom-left {

      bottom: 0;

      left: 0;

      clip-path: polygon(0 100%, 100% 100%, 0 0);

      }

      /* Header Section */

      .receipt-header {

      background: #fff;

      border-bottom: 1px solid #ddd;

      padding: 20px;

      display: flex;

      justify-content: space-between;

      align-items: center;

      }

      .receipt-header img {

      height: 50px;

      }

      .receipt-header .payment-details {

      text-align: right;

      font-size: 14px;

      color: #333;

      }

      .barcode {

      margin-top: 10px;

      }

      /* Content Section */

      .receipt-content {

      padding: 20px;

      }

      .receipt-section {

      margin-bottom: 20px;

      }

      .receipt-section h3 {

      font-size: 16px;

      font-weight: bold;

      margin-bottom: 10px;

      color: #333;

      border-left: 4px solid #f7b500;

      padding-left: 10px;

      }

      .receipt-section p {

      font-size: 14px;

      margin-bottom: 5px;

      color: #555;

      }

      /* Total Amount */

      .total-amount {

      background-color: #f7b500;

      color: #333;

      padding: 10px;

      text-align: center;

      font-size: 18px;

      font-weight: bold;

      margin-bottom: 20px;

      }

      .total-amount small {

      display: block;

      font-size: 12px;

      color: #333;

      }

      /* Table Section */

      .table-container {

      overflow-x: auto;

      }

      .receipt-table {

      width: 100%;

      border-collapse: collapse;

      margin-bottom: 20px;

      }

      .receipt-table th,

      .receipt-table td {

      border: 1px solid #ddd;

      padding: 10px;

      font-size: 14px;

      text-align: left;

      }

      .receipt-table th {

      background-color: #f9f9f9;

      font-weight: bold;

      }

      /* Footer */

      .receipt-footer {

      padding: 10px 20px;

      background-color: #f9f9f9;

      font-size: 12px;

      color: #555;

      text-align: center;

      border-top: 1px solid #ddd;

      }

      .make_bold {

      font-weight: bold;

      }

      .receipt-footer span {

      font-weight: bold;

      }

      @media print {

      * {

      margin: 0;

      padding: 0;

      box-sizing: border-box;

      }

      .content-wrapper {

      font-family: Arial, sans-serif;

      background-color: #f5f5f5;

      display: flex;

      justify-content: center;

      align-items: center;

      min-height: 100vh;

      padding: 20px;

      }

      .receipt {

      max-width: 800px;

      width: 100%;

      background: #fff;

      border-radius: 8px;

      position: relative;

      overflow: hidden;

      border: 1px solid #ddd;

      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);

      }

      /* Yellow Corners */

      .receipt::before,

      .receipt::after,

      .receipt .corner-top-right,

      .receipt .corner-bottom-left {

      content: '';

      position: absolute;

      width: 40px;

      height: 40px;

      background-color: #f7b500;

      }

      .receipt::before {

      top: 0;

      left: 0;

      clip-path: polygon(0 0, 100% 0, 0 100%);

      }

      .receipt::after {

      bottom: 0;

      right: 0;

      clip-path: polygon(100% 100%, 0 100%, 100% 0);

      }

      .receipt .corner-top-right {

      top: 0;

      right: 0;

      clip-path: polygon(100% 0, 100% 100%, 0 0);

      }

      .receipt .corner-bottom-left {

      bottom: 0;

      left: 0;

      clip-path: polygon(0 100%, 100% 100%, 0 0);

      }

      /* Header Section */

      .receipt-header {

      background: #fff;

      border-bottom: 1px solid #ddd;

      padding: 20px;

      display: flex;

      justify-content: space-between;

      align-items: center;

      }

      .receipt-header img {

      height: 50px;

      }

      .receipt-header .payment-details {

      text-align: right;

      font-size: 14px;

      color: #333;

      }

      .barcode {

      margin-top: 10px;

      }

      /* Content Section */

      .receipt-content {

      padding: 20px;

      }

      .receipt-section {

      margin-bottom: 20px;

      }

      .receipt-section h3 {

      font-size: 16px;

      font-weight: bold;

      margin-bottom: 10px;

      color: #333;

      border-left: 4px solid #f7b500;

      padding-left: 10px;

      }

      .receipt-section p {

      font-size: 14px;

      margin-bottom: 5px;

      color: #555;

      }

      /* Total Amount */

      .total-amount {

      background-color: #f7b500;

      color: #333;

      padding: 10px;

      text-align: center;

      font-size: 18px;

      font-weight: bold;

      margin-bottom: 20px;

      }

      .total-amount small {

      display: block;

      font-size: 12px;

      color: #333;

      }

      /* Table Section */

      .table-container {

      overflow-x: auto;

      }

      .receipt-table {

      width: 100%;

      border-collapse: collapse;

      margin-bottom: 20px;

      }

      .receipt-table th,

      .receipt-table td {

      border: 1px solid #ddd;

      padding: 10px;

      font-size: 14px;

      text-align: left;

      }

      .receipt-table th {

      background-color: #f9f9f9;

      font-weight: bold;

      }

      /* Footer */

      .receipt-footer {

      padding: 10px 20px;

      background-color: #f9f9f9;

      font-size: 12px;

      color: #555;

      text-align: center;

      border-top: 1px solid #ddd;

      }

      .make_bold {

      font-weight: bold;

      }

      .receipt-footer span {

      font-weight: bold;

      }

      }

   </style>

   <body class="skin-blue-light sidebar-mini">

      <div class="wrapper">

      {% include "include_header.html" %}

      {% include "include_aside.html" %}

      <!-- Content Wrapper -->

      <div class="content-wrapper">

         <section class="content-header">

         </section>

         <div class="receipt" id="id_download_pdf">

            <!-- Yellow Corners -->

            <div class="corner-top-right"></div>

            <div class="corner-bottom-left"></div>

            <!-- Header -->

            <br>

            <br>

            <div class="receipt-header">

               <img src="{% static 'images/logo_rectangle.webp' %}" alt="Logo">

            </div>

            <!-- Content -->

            <div class="receipt-content">

               <!-- Member Details -->

               <div class="payment-details">

                  <p><strong>Payment ID:</strong> {{payment_det.paymentID}}</p>

                  <p><strong>Date:</strong> {{payment_det.payment_date}}</p>

               </div>

               <div class="side_by_side_div" style="display: flex; gap: 20px; align-items: flex-start;">

                  <!-- Content Section -->

                  <div id="content" style="flex: 1;">

                     <div class="receipt-section">

                        <h3>Member Details</h3>

                        <p><strong>Member ID:</strong> {{payment_det.member_reg_no}}</p>

                        <p>

                           <strong>Name:</strong>

                           {% if basic_details.doctor_name %}

                           {{basic_details.doctor_name}}

                           {% elif basic_details.hospital_name %}

                           {{basic_details.hospital_name}}

                           {% endif %}

                        </p>

                        <p><strong>Address:</strong> {{basic_details.house_no}}  {{basic_details.street}} {{basic_details.state}} {{basic_details.city}} {{basic_details.pincode}}</p>

                        <p><strong>Contact No:</strong> {{basic_details.mobile_number}}</p>

                        <p><strong>Email:</strong> {{basic_details.email}}</p>

                     </div>

                     <!-- Subscription Details -->

                     <div class="receipt-section">

                        <h3>Subscription Details</h3>

                        <p><strong>Category:</strong> {{payment_det.insured_type}}</p>

                        <p><strong>Membership Tenure:</strong> {% if basic_details.tenure_of_membership %}{{basic_details.tenure_of_membership}} Year {% else %} 0 Year {% endif %}</p>

                        <p><strong>Indemnity Tenure:</strong> {% if basic_details.tenure_of_indemnity %}{{basic_details.tenure_of_indemnity}} Year {% else %} 0 Year {% endif %} </p>

                        <p><strong>Insurance Cover:</strong> {{basic_details.coverage_amount}}</p>

                     </div>

                  </div>

                  <!-- Total Amount Section -->

                  <div id="total" style="flex: 0 0 300px; text-align: center;">

                     <div class="total-amount" style="background-color: #f7b500; padding: 10px; ">

                        <strong>TOTAL AMOUNT</strong> <BR>

                        {{total_amount}} <br>

                        <small>{{amount_in_words}} only</small>

                     </div>

                  </div>

               </div>

               <!-- Payment Details -->

               <div class="receipt-section">

                  <h3>Payment Details</h3>

                  <div class="table-container">

                     <table class="receipt-table">

                        <thead>

                           <tr>

                              <th>SN.</th>

                              <th>Payment Mode</th>

                              <th>Amount</th>

                              <th>Cheque No. / Ref No.</th>

                              <th>Cheque Date</th>

                              <th>Bank Name</th>

                           </tr>

                        </thead>

                        <tbody>

                           {% for data in multi_table_lsit %}

                           <tr>

                              <td>{{forloop.counter}}</td>

                              <td>{{data.payment_mode}}</td>

                              <td>{{data.transaction_amount}}</td>

                              <td>{{data.transaction_ref_no}}</td>

                              <td>{{data.transaction_date}}</td>

                              <td>{{data.bank_name}}</td>

                           </tr>

                           {% endfor %}

                        </tbody>

                     </table>

                  </div>

               </div>

               <!-- Notes -->

               <div class="receipt-section">

                  <h3>Note:</h3>

                  <p style="font-size: 12px; color: #555;">

                     * Insurance Premium is

                     received on behalf of the Insurance Company.<br>

                     * Membership documents will be valid only after payment realization.<br>

                     * Company will not be liable for payments made through self-cheque.<br> 

                     * Payment is non-refundable. <br> 

                     Collected By:  {{user.name}}

                     <br> Area:  {{user.area}} <br> 

                  </p>

               </div>

            </div>

            <!-- Footer --> 

            <div class="receipt-footer">

               <p><span>HEAD OFFICE</span>: CW-59 SGT Nagar, Near Samaypur Badli, Delhi - 110042</p>

               <p><span>REG. OFFICE</span>: Flat no 302, Sarojni Apartment, Near CM House, Morabadi, Ranchi, Jharkhand - 834008</p>

               <p><span>Corp. Office</span>: 4th floor, 307, Spectrum Tower, Mindspace, Chincholi Bunder Road, Malad West, Mumbai, Maharashtra, 400064</p>

            </div>

         </div>

         

      </div>

      <!-- .content-wrapper --> 

      <div class="button-container text-center mt-4 mb-2">

         {% comment %} <button onclick="printDiv('id_download_pdf')" class="btn btn-primary">Print</button> {% endcomment %}

         <button onclick="downloadAsPDF('id_download_pdf')" class="btn btn-success">Download PDF</button>

         {% comment %} <button onclick="downloadPDF()" class="btn btn-success">Download as PDF</button> {% endcomment %}

      </div>

      <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

      <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

      <script type="text/javascript">

         function downloadAsPDF(divID) {

            const element = document.getElementById(divID);

            

            const { jsPDF } = window.jspdf;

            const pdf = new jsPDF({

              orientation: 'portrait',

              unit: 'mm',

              format: 'a4'

            });

            

            html2canvas(element, {

              scale: 2, // Higher scale for better resolution

              useCORS: true, // Enable cross-origin resource sharing for external assets

            }).then(canvas => {

              const imgData = canvas.toDataURL('image/png');

              

              const pdfWidth = pdf.internal.pageSize.getWidth();

              const pdfHeight = (canvas.height * pdfWidth) / canvas.width;

        

              pdf.addImage(imgData, 'PNG', 0, 0, pdfWidth, pdfHeight);

              pdf.save('registration_details.pdf');

            });

          }

         

         function printDiv(divID) {

             const idCard = document.getElementById(divID);

             const originalContents = document.body.innerHTML;

             

             // Temporarily hide other elements

             document.body.innerHTML = idCard.innerHTML;

             window.print();

         

             // Restore the original content after printing

             document.body.innerHTML = originalContents;

         }

      </script>

      <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

      <script>

         // Function to print the ID card

         {% comment %} function printIDCard() {

             window.print();

         } {% endcomment %}

         

         // Function to download the ID card as a PDF

         function downloadPDF() {

             const idCardElement = document.querySelector('#id_download_pdf');

             const options = {

                 margin: 0,

                 filename: 'ID_Card.pdf',

                 image: {

                     type: 'jpeg',

                     quality: 0.98

                 },
                 html2canvas: {

                     scale: 2

                 },

                 jsPDF: {

                     unit: 'in',

                     format: 'a4',

                     orientation: 'portrait'

                 }

             };

             html2pdf().set(options).from(idCardElement).save();

         }

      </script>

      {% include "include_footerjs.html" %} 

      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js\"></script> 

   </body>

</html>